using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Drawing;
using System.Reflection.Emit;
using System.Windows.Forms;
using static System.Net.Mime.MediaTypeNames;

namespace KenisBank
{
    public partial class KennisMainForm : Form
    {
        Regel regels = new Regel();

        public KennisMainForm()
        {
            InitializeComponent();
        }

        private void buttonSave_Click(object sender, EventArgs e)
        {
            
        }

        private void KennisMainForm_Shown(object sender, EventArgs e)
        {
            // laad main.xml
            regels.Laad(@"Data\main.xml");
        }

        private void buttonEdit_Click(object sender, EventArgs e)
        {
            buttonSave.Enabled = !buttonSave.Enabled;
            buttonVoegToe.Enabled = !buttonVoegToe.Enabled;
        }

        private void buttonVoegToe_Click(object sender, EventArgs e)
        {
            

            // add HoofdstukText
            AddHoofdstuk("Hoofdstuk tekst");

            // add text
            string tekst = "13-10-20 R.Docter diverse aanpassingen.\r\n14-10-20 eerste versie test.\r\n15-10-20 M.Kieft bug load personeel vanuit verleden.\r\n17-10-20 Geel Minimize knopje history venster.\r\n17-10-20 Geel Grijze balk van werkplek over gehele breedte.\r\n17-10-20 Geel History filter verbeterd.\r\n18-10-20 Extra diensten en aanvraag niet visible als niet gebruik.\r\n18-10-20 Tel niet mee in telling toegevoegd.\r\n19-10-20 M.Kieft Afwijkingen van ingelogd persoon telling gemaakt.\r\n21-10-20 Vonhoff bug bij verhuizing niet kunnen invullen.\r\n21-10-20 inlog\r\n21-10-20 Boots DD toegevoegd\r\n22-10-20 M.Kieft Afwijkingen van ingelogd persoon beter in excel.\r\n22-10-20 Haaften E-mail en Adres per kleur\r\n24-10-20 Netwerk save en load 30 keer proberen ivm traagheid.\r\n25-10-20 M.Kieft Telling Ploeg en Persoon er in gezet.\r\n28-10-20 Oude data inlezen vanaf 1-1 vorig jaar.\r\n28-10-20 Majaar Bij Edit personeel rechten worden oude rechten meegenomen.\r\n28-10-20 Haaften Optie VRIJ.\r\n28-10-20 Haaften Als na laatste nacht een OPLO/K , Dan vraag VRIJ nacht er voor.\r\n29-10-20 About versie text in versie.ini file.\r\n29-10-20 Bug in edit personeel isw met filter kleur.\r\n30-10-20 Bezetting lijst save 30 pogingen.\r\n30-10-20 Boots Scroll Windows als klein scherm.\r\n31-10-20 Backup van files 1 keer per dag.\r\n02-11-20 Boots Invoer reeks X maal met interval Y.\r\n03-11-20 bug verander file bij nieuwe aanmaak maand.\r\n03-11-20 history verbeterd.\r\n04-11-20 Boots Melding verkeerd wachtwoord.\r\n04-11-20 Boots Bug ver in toekomst invullen.\r\n04-11-20 Tooltip.\r\n05-11-20 Den Blanken Verbetering nacht ervoor vrij.\r\n06-11-20 Diverse.\r\n07-11-20 Heesterbeek diverse labels/teksten anders.\r\n07-11-20 Dialoog als form dialoog ipv sizeable.\r\n07-11-20 History filter alleen op Datum.\r\n09-11-20 Heesterbeek ED/VD/RD in wachtoverzicht werkplek locatie.\r\n19-11-20 Heesterbeek kleur code in wachtoverzicht bij afwijking.\r\n22-11-20 Alleen uppercase invoeren afwijking.\r\n22-11-20 Source geoptimaliseerd door Visual studio.\r\n22-11-20 EV ook kleur in wachtoverzicht.\r\n23-11-20 Copy funtie in quickmenu invullen afwijking.\r\n23-11-20 Boots Copy afwijking dag door naar afwijking reeks.\r\n25-11-20 Heesterbeek Start wacht overzicht formulier 2 dagen.\r\n25-11-20 Admin WW aangepast aan oude wachtrapport rep tool.\r\n26-11-20 Brasser Screen shot bug wachtmail.\r\n26-11-20 Bug verhuis tool.\r\n26-11-20 Brasser lijntjes naar boven verplaatst.\r\n28-11-20 Heesterbeek Wachtoverzicht optie form 2 dagen.\r\n30-11-20 VK1 VK2 VK3 enz in kleur in overzicht.\r\n01-12-20 Test Netwerk voordat wijzeging of nieuwe bezetting maken.\r\n02-12-20 11 maanden ingevulde wijzegingen worden meegenomen bij verhuizing.\r\n03-12-20 den Blanken Bug geen vuilwerk bij ED/RD/VD opgelost.\r\n05-12-20 Cancel verhuis data terug zetten.\r\n06-12-20 den Blanken Auto inlog gebeuren.\r\n06-12-20 personeel kleur als dropdown ipv vrije tekst.\r\n10-12-20 in form balk ingelogde naam en personeel nummer.\r\n10-12-20 Na wijzigen rechten meteen update in personeel form.\r\n13-12-20 Bug invoeren access database.\r\n13-12-20 Kieft Bug screen bevroren na opstarten.\r\n20-12-20 Verbeterde invoer oude database oude bezetting.\r\n22-12-20 Zaaijer Bug invoer nieuwe namen met passwoord leeg.\r\n22-12-20 Bij rechten > 0 aanpassen en passwoord leeg, passwoord reset.\r\n22-12-20 Bij auto inlog check of persoon nog bestaat, anders verwijderen.\r\n22-12-20 Test auto rechten bij invoer vanuit oude programma.\r\n23-12-20 Zaaijer/Visser Opmerkingen in dag/wacht formulier.\r\n25-12-20 Kieft Bug wachtoverzicht volgende/vorige bij jaar overgang.\r\n26-12-20 5 ploegen data kleur en dag keuze in losse dll gezet.\r\n29-12-20 Bug opslag maand jpg.\r\n02-01-21 Bug opstart bij nieuw jaar als kleur niet bekend was.\r\n04-01-21 Bij meer dan 1 extra dienst, deze alle in popup in maand overzicht.\r\n07-01-21 Digitaal sign ivm opstart melding tatasteeleurope.\r\n10-01-21 Test of kill.ini meer dan 30 min oud is, verwijder deze dan.\r\n10-01-21 Test Lees en Schrijf toegang voordat we opstarten.\r\n12-01-21 Boots Mogelijkheid tot aanpassen pop-up menu.\r\n12-01-21 Boots Optie om oude data in te lezen vanaf huidige datum, of hele jaar.\r\n17-01-21 Auto inlog verbeterd.\r\n22-01-21 Blanken Bug bij naam veranderen van peroneel.\r\n22-01-21 Lagerwey Bug bij invullen DD man bij 5ploegendienst rooster.\r\n23-01-21 Lagerwey Bij extra text aanwezig in wachtoverzicht, knopje geel.\r\n25-01-21 Lagerwey Knopje 2de dag in wachtoverzicht met kleur.\r\n25-01-21 Lagerwey/Docter keuze datum op wachtoverzicht formulier.\r\n25-01-21 Bij import vanuit oude access database ook verwijdering afwijking meenemen.\r\n29-01-21 Reperatie bezetting met wijzeging file verbeterd.\r\n29-01-21 Bug opmerkingen plaatsen 2de dag wachtoverzicht.\r\n01-02-21 Toevoegen export maandoverzicht naar Excel.\r\n01-02-21 Check of directory Backup bestaat, anders aanmaken.\r\n02-02-21 Lagerwey alle hulpfiles in andere directory, BezData.\r\n02-02-21 Bij import vanuit oude access database ook verwijdering afwijking meenemen(2).\r\n08-02-21 Bij lage resolutie form grote aanpassen.\r\n12-02-21 Lagerwey Reeks Verschoven diensten invullen.\r\n14-02-21 Probleem wijzigen ED naar VD op zelfde dag aangepakt.\r\n15-02-21 Color kolom ging soms te ver door als er extra diensten waren.\r\n21-02-21 Lagerwey Bug, in ploegbezetting bestond wel een persoon, maar niet die werkdag.\r\n23-02-21 Lamme, melding als ingelogd met rechten 1.\r\n27-02-21 Verhuis aangepakt.\r\n01-03-21 Wachtoverzicht bij overgang maand aangepakt.\r\n02-03-21 Lamme, bij aanpassen record personeel, bewaar rechten en passwoord.\r\n02-03-21 Lamme, ipv RD ED en VD ook DD, dus een dag DagDienst lopen.\r\n04-02-21 Verhuis verbeterd met kill.ini en hulp teksten.\r\n13-03-21 Maand overzicht anders opslaan.\r\n13-03-21 Test dubbele achternaam.\r\n13-03-21 Als admin achternaam wijzigen als 2 maal zelfde achternaam.\r\n13-03-21 Stigchel, Reeks invoer gerepareerd.\r\n13-03-21 Stigchel, Bij toevoegen persoon op kleur, aanpassen werkdagen.\r\n13-03-21 Seker, Als je rechten hebt van 50, blokeer zelf verhogen.\r\n14-03-21 Katuin, Opgelost indien er gewijzigd wordt dan zien de anderen de wijziging niet.\r\n14-03-21 Katuin, Hover Time variable.\r\n14-03-21 Refresh knop wijzigd als er geupdated versie is.\r\n14-03-21 Melih, Tekst fout aangepast.\r\n14-03-21 In history venster naam ipv personeel nummer.\r\n14-03-21 Naar 64 bits ipv 32 bits\r\n14-03-21 refresh knopje wordt rood als er door iemand anders gewijzigd is.\r\n15-03-21 Lagerwey, Week nummer was 1 versprongen.\r\n16-03-21 bij refresh wordt overwerk tabel opnieuw gemaakt.\r\n17-03-21 Iglesias, Kleur schema aangepast.\r\n17-03-21 Start help scherm.\r\n17-03-21 Haaften, Popup rede weer gerepareerd.\r\n18-03-21 Seker, teller waar gewerkt als er extra diensten zijn.\r\n18-03-21 Katuin, Backup aangepast, 3 maanden met naam van die maand.\r\n18-03-21 Katuin, Na verhuizing data van persoon aanpassing geblokkeerd.\r\n20-03-21 invoer nu op personeel nummer, naam kan je dus aanpassen.\r\n20-03-21 Verhuis Tool verbeterd.\r\n22-03-21 blokeren maand datum vernieuwen/clearen.\r\n23-03-21 Als Admin mogelijkheid tot start backup nu.\r\n25-03-21 Backup locatie.txt toegevoegd.\r\n28-03-21 Katuin, Excel jaar overzicht.\r\n28-03-21 Afwijkingen jaar ongeclusterd.\r\n29-03-21 Kieft, knopje naar ploegendienst kalender.\r\n30-03-21 Backup roetine opruiming verbeterd.\r\n30-03-21 Debug panel gemaakt, bv voor backup.\r\n30-03-21 Kieft, Verhuizing naar \"Weg\" opgelost.\r\n31-03-21 Start gemaakt (UI) reeks invoer DD-DD-DD-DD-DD-X-X\r\n01-04-21 Backup met start 00:00 ging fout, nu op > 01:00\r\n01-04-21 Kieft, Vanuit form afwijking dag naar afwijking reeks wordt rede meegenomen.\r\n03-04-21 Jansen-Blanken , Naam bij hover over veld voor invoer.\r\n03-04-21 Katuin, Reeks invoer DD-DD-DD-DD-DD-X-X gemaakt.\r\n06-04-21 Kieft, Bug telling afwijkingen persoon gevonden en opgelost.\r\n07-04-21 Toggle mogelijkheid wachtoverzicht 1 of 2 dagen.\r\n16-04-21 Katuin, Bij verhuizing nieuwe persoon rechten meegeven die maand.\r\n22-04-21 Bij snelle Save achter elkaar even sleep ivm traagheid netwerk\r\n22-04-21 Bij verhuizing saven oude data op schijf.\r\n22-04-21 Start gemaakt Admin menu in Personeel form ivm reparatie.\r\n22-04-21 Als admin direct verhuizen.\r\n23-04-21 Bakker, Get kleur met overgangs datum aanroep (bij reeks invoer)\r\n23-04-21 Schilte, Bij verhuis rechten om in te vullen.\r\n23-04-21 Woude van der, in titel sectie.\r\n24-04-21 Reeks invoer max 3 met sleep ivm traagheid netwerk\r\n25-04-21 Quax, Ingelogd persoon een kleurje.\r\n26-04-21 Zaaijer, Nieuw persoon bug en tekst aangepast.\r\n26-04-21 Start prive/eigen opslag optie's\r\n29-04-21 Auto inlog en 2 dagen onder prive data gezet.\r\n02-05-21 Bug maken wachtoverzicht op huidige maand.\r\n03-05-21 Keuze kleur bij import oude afwijking file.\r\n04-05-21 Stichel, Tel mobiel en prive in excel lijst.\r\n04-05-21 Keuze wachtoverzicht invisible, bv bij DD\r\n05-05-21 Wacht netwerk knop met text\r\n05-05-21 Wait load en save telling aangepast\r\n05-05-21 Boots, Sorteer lijst in edit namen form\r\n12-05-21 Boots, Sorteer op Kolom klik edit namen form.\r\n12-05-21 Boots en Simons, Rechten 26 en 27.\r\n18-05-21 Zutphen en Muis, Snipperdag aanvraag bij goedkeuren in bezetting zetten.\r\n21-05-21 Help file als DOC.\r\n25-05-21 Lagerwey, Ruil/Extra form aangepakt. Sorteren, verwijderen, intrekken.\r\n29-05-21 Boots, sorteren van werkplekken in maandoverzicht optie, met prive optie.\r\n01-06-21 vd Woude, bug tellen afwijkingen eigen data.\r\n16-06-21 Aanpassing wachoverzicht, kleur_Werkplek ipv kleur_bezetting.bin\r\n16-06-21 Backup Help file aangepast.\r\n16-06-21 Blanken Den, Copy van 1 dag in wachtoverzicht aangepast.\r\n18-06-21 Haaften, verbeteringen extra diensten update.\r\n18-06-21 Haaften, Bij excel heel jaar en geen maand bekend melding aangepast.\r\n18-06-21 Dag ploegen rooster in maandoverzicht.\r\n21-06-21 Haaften, Wachtoverzicht copy 1 dag bug.\r\n23-06-21 Sneltoets Esc voor uitloggen.\r\n25-06-21 Refresh button met kleur in wachtoverzicht.\r\n27-06-21 Wachtoverzicht versneld opbouw.\r\n03-07-21 Start 2 maal invoeren naam bij wachtoverzicht.\r\n04-07-21 Haaften, bij hertellen ED afvangen als verkeerd is ingevuld.\r\n05-07-21 Nicolai, zelfde naam 2 maal invullen overzicht.\r\n05-07-21 Bug, copy van wachtbezetting 1 dag opgelost.\r\n07-07-21 Sorteren en Filteren aanvraag snipperdagen.\r\n07-07-21 Nicolai, verwijderen van dubbel naam in wachtoverzicht.\r\n07-07-21 Cancel je eigen snipperdag aanvraag bij rechten 1.\r\n10-07-21 Wachtdata aangepakt.\r\n11-07-21 In Wachtoverzicht afwijking lijst volgt namen lijst (lange lijst cgm)\r\n11-07-21 Auto refresh wachtoverzicht.\r\n11-07-21 Lagerwey, filter zelf ingetrokken extra/ruil dienst.\r\n22-07-21 Ruil/Extra en Snipperdagen form en logica verbeterd.\r\n26-07-21 Blanken, dag afwijking invoer en reeks als datetime ipv string.\r\n27-07-21 Nicolai, Extra dienst invullen als persoon op \"Gast\" ploeg zit.\r\n27-07-21 In dropdown keuze kleur, alle mogelijkheden welke in Namen zitten als rechten > 50\r\n31-07-21 Aarts, invullen spatie's als afwijking blokeren.\r\n01-08-21 Bunt vd, Stello, wacht overzicht 2 dagen spring op dienst nivo.\r\n01-08-21 2de copy knop in wachtoverzicht 2 dagen.\r\n01-08-21 Bunt vd, filter op kleur in snipperdagen aanvraag.\r\n05-08-21 Gosewehr,Kijk funtie personeel als rechten > 24\r\n05-08-21 Beveiliging, bewaking op juist personeel nummer invoeren nieuwe naam.\r\n19-08-21 Bij verwijderen persoon gaat deze naar ploeg \"Weg\" ipv delete.\r\n21-08-21 Bakker R, Bug verhuizing bij nieuw jaar als directory's niet bestaan.\r\n25-08-21 Hint maand nummer\r\n25-08-21 Bakker R, Bij openen edit personeel aaltijd select eerste persoon.\r\n30-08-21 Bakker J, Betere omschrijving bij verwijderen personeel.\r\n31-08-21 Mardiotto, Met rechten 0 toch history wijzegingen bekijken.\r\n01-09-21 Mardiotto, Bij import datum invoer oude programma meenemen.\r\n01-09-21 Bug overgang wachtoverzicht terug stappen als maand niet bestond.\r\n04-09-21 Log venster bij copy actie in wachtoverzicht 2 wachten.\r\n05-09-21 Heesterbeek, Scroll bar afwijkingen volgt namen in wachtoverzicht2.\r\n06-09-21 Luntz, Sorteer roetine in namen/afwijkingen wachtoverzicht.\r\n08-09-21 Log venster bij copy actie in wachtoverzicht 1 wacht.\r\n09-09-21 vd Bergh, 5 kleur lijnen in wachtoverzicht.\r\n10-09-21 Katuin, Excel ipv 20 regels 35 regels.\r\n11-09-21 Mardiotto, Bug kleur in geselecteerde naam in wachtoverzicht.\r\n13-09-21 Bakker R, Beveilig 2 keer persoon invullen met zelfde personeel nummer.\r\n16-09-21 E-Mail bezetting maand en jaar.\r\n18-09-21 Melding 2 keer persoon invullen met zelfde achternaam.\r\n24-09-21 Bakker R, verhuis maand lijst ging verkeerd met jaar overgang.\r\n25-09-21 Bug extra/ruil opgelost als naam zeer kort was.\r\n29-09-21 Bug Alfonsi auto refresh als maand en jaar niet klopt.\r\n01-10-21 Wacht opmerkingen te zien voor read-only gebruikers.\r\n01-10-21 Bug, Als rechten <51 dan alleen mensen toevoegen op eigen kleur.\r\n01-10-21 Bug Mardiotto, sorteer datum velden op datum ipv strings.\r\n03-10-21 Stello, In wachtoverzicht mogelijkheid tot afwijkingen invoeren.\r\n04-10-21 Pvk, 12 maanden ruil/extra vooruit werken.\r\n04-10-21 Help text in wachtoverzicht.\r\n08-10-21 Katuin, zelf bedenken welke kleuren kunnen lopen bij extra diensten.\r\n08-10-21 Katuin, Melding in maand overzicht als extra dienst gevraagd wordt.\r\n19-10-21 Alfonsi, Vakjes in Kleur kunnen zetten.\r\n19-10-21 Tips toegevoegd.\r\n23-10-21 Melding als resolutie te klein is, en formulier wordt aangepast.\r\n29-10-21 Bug v Vierzen, per ongeluk in edit mode in wachtview.\r\n30-10-21 Gevolg schade van bug 29-10-21 afgevangen, werkplek \"-\" wordt \"\"\r\n01-11-21 Toevoegen Nieuw Persoon pas na indrukken Nieuw Persoon.\r\n02-11-21 Extra test bij saven maand data.\r\n03-11-21 MaandDataClass versneld en verbeterd.\r\n05-11-21 Posthumus, Print funtie wachtoverzicht.\r\n05-11-21 Vierzen, Vraag spring naar eigen kleur bij inloggen.\r\n05-11-21 Driel van, bij meer dan 42 regels, blijf ik dienst en rooster vasthouden bij scroll.\r\n05-11-21 Kuil, Afwijkingen veld breder in Overzicht Wacht Form.\r\n08-11-21 Kuil, Mogelijkheid om op te starten in Wacht Form ipv Maand Form.\r\n09-11-21 Boots, Niet springen naar eigen kleur bij inloggen bij DD.\r\n09-11-21 Bug als namen waren ingevuld in wachtform als werkplek verwijderd was.\r\n10-11-21 Werkplek roetine verbeterd.\r\n12-11-21 Werkplek en Maandoverzicht buttons disabled bij opbouwen scherm.\r\n13-11-21 TimerKill gesplitst in TimerKill en TimerUpdate.\r\n17-11-21 Extra Info als IsGebruikerEenAdmin()\r\n18-11-21 Haaften van, Bug bij nieuwe wacht data en opslaan als geen aantal.\r\n19-11-21 Huidig Jaar keuze en intern veranderd ivm terug springen.\r\n21-11-21 Diverse, e-mail wachtvieuw, screen lock opbouw wachtview.\r\n23-11-21 Bug, Bij invoeren extra dienst, kijk eerst of die persoon al niet iest heeft op die dag.\r\n27-11-21 Heesterbeek, intrekken extra/ruil als niet is ingevuld\r\n27-11-21 Mardiotto, andere kleur kiezen in wachtoverzicht.\r\n02-12-21 Kleur kiezen wachtoverzicht niet alleen op kalender.\r\n02-12-21 Contrast verhoogd wachtoverzicht.\r\n02-12-21 Maandoverzicht aanpassen als scherm te klein is.\r\n09-12-21 Voorthuizen, print funtie in maand overzicht.\r\n09-12-21 Zaaijer, melding als kalender niet geinstallerd in door Tata.\r\n09-12-21 Koster, Rede afwijking te zien in wachtoverzicht als popup.\r\n11-12-21 Heesterbeek, bug TestJuisteMaandJaarInBeeld() als wachtoverzicht voor staat.\r\n11-12-21 Bij invullen extra/ruil kan je rede/opmerking meegeven aan maandoverzicht.\r\n11-12-21 Bug, aanvraag snipper bij rechten 0\r\n13-12-21 Volgorde implantatie wachtoverzicht, tips aangepast, {kleur}_WerkPlekPos.bin\r\n14-12-21 Auto Tips.\r\n16-12-21 Admin Bug Check dubbele namen.\r\n18-12-21 Bug import oude bezetting in verleden.\r\n21-12-21 Looberg, afwijkingen invullen in wachtoverzicht verbeterd.\r\n21-12-21 Heesterbeek, snipperdagen aanvraag in toekomst verhoogd van 10 naar 18 maanden.\r\n21-12-21 +Naam invullen afwijking in wachtoverzicht.\r\n03-01-22 Als iemand bv ED-O loopt en ook N, beide laten zien in wachtoverzicht.\r\n03-01-22 DatumVijfPloegen.DLL aangepast vanaf 2020 ipv 2015 voor snelheid.\r\n10-01-22 Verwijder persoon hulp teksten verbeterd in personeel form.\r\n11-01-22 Check dubbele namen van rechten 101 verhuisd naar 100.\r\n12-01-22 Backup versie 2 ivm data op Q schijf.\r\n16-01-22 Seker Unal, inlog vorige personeel nummers bewaard.\r\n21-01-22 Seker Melih, excel waar gelopen foutje.\r\n22-01-22 Visser, Bugje wachtoverzicht Schrikkel jaar\r\n26-01-22 Seker Unal, bij aanvraag snipperdagen layout vergroot.\r\n26-01-22 Inlog scherm verbeterd.\r\n01-02-22 Delete Peroneel verwijderd, alleen verplaatsten naar \"Weg\"\r\n01-02-22 About en Help vervangen voor Versie in menu balk.\r\n09-02-22 Vuilwerk nu ook te doen op werkplek, vuilwerk2.ini (RST OSF2)\r\n09-02-22 Blanken, Bug bij +naam in 1 wachtview form.\r\n09-02-22 Visser, 4 OI eerste en laatste in afwijking keuze lijst.\r\n10-02-22 Wizzard wijzegen van personeel nummer.\r\n10-02-22 Bug, bij afwijking invullen, blokeer backup.\r\n10-02-22 Vuilwerk Excel file naar format zonder macro\r\n11-02-22 BackupBezig.txt, blokeer invoer als op andere pc backup draaid.\r\n13-02-22 Boots, Bug na reset wachtwoord op eigen windows pc geen vraag nieuw wachtwoord.\r\n14-02-22 Bij openen personeel form, meteen sorteer op achternaam (default).\r\n15-02-22 Muis, Bug naam invullen ruildienst ipv kiezen uit lijst.\r\n16-02-22 CGM, rechten 1 bedacht, zelfde als rechten 0 maar met optie tot wijzigen wachtwoord.\r\n17-02-22 Extra hulp form met uitleg rechten.\r\n20-02-22 Logging rechten en inloggen\r\n24-02-22 Seker Unal, iest meer ruimte in main scherm voor afwijkingen.\r\n25-02-22 Bug, opruim roetine oud personeel op ploeg \"weg\".\r\n01-03-22 Seker Unal, Meer ruimte in 2 dagen wachtoverzicht.\r\n01-03-22 Div, Aanvraag van een reeks dagen in aanvraag onderdeel.\r\n04-03-22 WET, Telling extra/minimaal/aantal mensen per sectie.\r\n06-03-22 CGM, bij Verhuizing neem ik 12 maanden mee naar nieuwe kleur ipv 6.\r\n10-03-22 RST, Vuilwerk aangepast.\r\n14-03-22 WB2, Font in wachtview iets groter.\r\n19-03-22 Mogelijkheid tot vergroten/verkleinen listboxen in wachtview.\r\n25-03-22 Dijkhuis, bij te kleine resolutie wachtview met 1 dag laten zien.\r\n29-03-22 Bug, bij MaandOvergang in wachtoverzicht bij wijzigen data halen van netwerk ipv buffer.\r\n20-04-22 Import/Export bij overgang andere sectie, daardoor ook bij verhuis funtie.\r\n04-05-22 Kieft, spelling fout hulp rechten.\r\n04-05-22 Bij import/export melden in log file's\r\n04-05-22 Bug, bij kleur_namen.bin maken altijd laatse versie maken ipv online file.\r\n05-05-22 Seker Melih, spelfout feestdagen.\r\n06-05-22 Bug, in wachtoverzicht geen X bij verhuizing.\r\n20-05-22 E Van Zutphen , Bug bij Scaling van scherm geen capture scherm.\r\n25-05-22 Schoorl Remy, log werkplek veranderen en copy naar volgende dag.\r\n25-05-22 Log File te bekijken via menu Beheer.\r\n31-05-22 Log file form verbeterd, volgende en vorige maand en uitlijning.\r\n01-07-22 Bug, alleen opslaan plaatje wachtoverzicht door iemand met rechten.\r\n01-07-22 Oude Werkplek.cs verwijderd, nu WerkplekPos.cs alleen actief\r\n06-07-22 E van Zutphen , Bug bij form close 2wachtform geen opslag data.\r\n12-07-22 Bij Refresh scherm (F5) en voldoende rechten hertel extra diensten.\r\n16-07-22 Bij Refresh dit ook schrijven in log file.\r\n20-07-22 Bij Personeel nummer veranderen, dit ook schrijven in log file.\r\n20-07-22 Bij Personeel Save, dit ook schrijven in log file.\r\n20-07-22 Default Dir opslaan export naam op desktop.\r\n20-07-22 Bij Personeel nummer aanpassen, ook aanvraag snipperdagen aanpassen.\r\n25-07-22 Bij iemand verplaatsen naar \"Weg\", zijn achternaam veranderen \r\n\t zodat nieuw persoon met zelfde achternaam toegevoegd kan worden.\r\n11-08-22 Bug, Bij e-mail huidige maand eerst opslaan.\r\n11-08-22 Bug, Bij aanpassen maanddata en nieuwe maand, extra sleep time ivm netwerk.\r\n14-08-22 Bij Log nieuwe lege maand de maand en jaar er bij.\r\n14-08-22 Brasser Mike, Trim funtie invoer bij afwijkingen.\r\n17-08-22 Thread.Sleep(1000) bij capture scherm voor print en e-mail\r\n19-08-22 Bug Woude van der Bij Check extra diensten vergat ik laatste dag.\r\n23-08-22 Bug Spruit P, bij invoeren van naam in extra/lijst, \r\n\t keek programma alleen naar datum, nu datum en dienst \r\n23-08-22 Bij invoer extra/ruil, ook in log file data zetten.\r\n26-08-22 Bug, er was een verkeerde kleur_extra.bin gemaakt, opgeslagen in verkeerde maand.\r\n30-08-22 Filter in log niet case sensitive.\r\n31-08-22 Jaar overzicht extra/ruil diensten.\r\n04-09-22 In Log een melding als er RD ED of VD geklopt wordt.\r\n09-09-22 E van Zutphen, bij wachtoverzicht2 opslaan plaatje dag 1 en 2 ivm mail programma.\r\n11-09-22 Afwijking datum per kleur gebruiken in maand overzicht data, info panel opslag en items.\r\n12-09-22 Extra info in info paneel.\r\n22-09-22 Bij CleanExtraDienstenLijst meenemen datum dat iemand verhuisd van kleur.\r\n25-09-22 Bijafwijking invoer voor hele ploeg, alleen invullen als er geen afwijking staat.\r\n03-10-22 C van Egmond, bij geen ruil of snipper aanvraag, geen rechten 1 mogelijk.\r\n07-10-22 R Plomp Persoon in verhuis roetine blokkeren een reeks invullen.\r\n10-10-22 P Spruit In Aanvraag snipper preview van bezetting.\r\n07-11-22 Kieft, Eerst jpg maken, daarna testen of juiste maand.\r\n16-11-22 Reeks invullen aantal verhoogd van 35 naar 300, dus checkfiles daarop aangepast.\r\n22-11-22 R Schoorl extra info bij invoer nieuw persoon.\r\n22-11-22 Lock data file bij multi user invullen.\r\n07-11-22 Savelege ploeg samen gevoegd.\r\n07-22-22 1 instance van programma maar mogelijk.\r\n08-12-22 ProgData.Main.PathWijzeging.Text in Quicksave\r\n20-12-22 Schoorl, Heesterbeek Start datum nieuw personeel invullen.\r\n27-12-22 Extra Backup van *_bezetting.bin elke week.\r\n10-01-23 Save bug in Personeel toevoegen opgelost.\r\n10-01-23 In Edit Personeel form bewaar gekozen naam.\r\n11-01-23 Mardiotto, in aanvraag snipperdagen form de  feestdagen en weekend dagen kleur.\r\n13-01-23 Backup van *_bezetting.bin elke week verbeterd.\r\n14-01-23 Lobregt, telling waar gewerkt ook over meerdere jaren mogelijk.\r\n28-01-23 Visser, als gebruiker rechten 50 dan mogelijkheid tot verhuizen op eigen ploeg.\r\n02-02-23 Backup makelijker en te doen voor gebruikers met rechten 99.\r\n04-02-23 MaandData invoer verder beveiligd.\r\n08-02-23 MaandData invoer vereenvoudigd.\r\n09-02-23 Bug : Wouder van der HaalPloegNamenOpKleur();\r\n09-02-23 Bij Dagdienst geen backup van kleur.bin data.\r\n14-02-23 Info scherm beneden in main Window.\r\n28-02-23 Backup Alleen nieuwe methode op Maandag en Donderdag. \r\n01-03-23 Backup in eigen class.\r\n03-03-23 Lobregt, Bij reeks invullen en vorige afwijking niet leeg, melding.\r\n08-03-23 Boots, Edit personeel form ivm laptop gebruik aangepast, en melding scaling.\r\n11-03-23 Noorlander, text aangepast bij meerdere instance van programma\r\n12-03-23 Seker Unal, OI tekst Begin eof Eind, wat beter past in wachtoverzicht.\r\n13-03-23 Seker Unal, Sorteer keuze in wachtoverzicht button.\r\n01-04-23 Woude van der, Zelf aanvragen auto mail versturen\r\n05-04-23 Woude van der, In aanvraag auto mail kiezen keuze of je wachtoverzicht wilt krijgen. \r\n20-04-23 Spruit Patrick, Alleen wacht rapport verzenden, geen Maand Rapport.\r\n26-04-23 Kramer Stephan. Datum in wachtoverzicht in nederlands format bij engels Windows.\r\n08-05-23 GetAfwijkingVoorWachtoverzicht aangepast.\r\n08-05-23 Main Form iets breder ivm scrollbar bij veel mensen en 31 dagen.\r\n08-05-23 Timers stopen bij maandinvoer Data.\r\n20-05-23 Berg Jos van den, aanroep van ruil/extra vanuit wachtview scherm.\r\n01-06-23 Rol Barry, test bij starten of windows in nederland staat.\r\n06-04-23 Kolsuz Osman, naam filter in history Form.\r\n22-06-23 Afbreek knopje bij reeks invoer als er al een afwijking staat.\r\n24-06-23 Edit wachtoverzicht Form als Admin.\r\n30-06-23 Restore Form voor backup terug zetten.\r\n10-07-23 Html opslag en web pagina.\r\n22-07-23 Juiste sectie naam in html file.\r\n25-07-23 Extra check bij maken nieuwe MaandData files\r\n01-08-23 Lobregt, Check bij ruil/extra of aanvraag datum niet in verleden ligt.\r\n07-08-23 Kleine Rob, berekening week nummers ging fout, nu volgens ISO 8601-standaard.\r\n15-08-23 Week nummer nu ook in kleur pop-up.\r\n17-08-23 Seker Unal, invoer datum nu ook laten zien in extra/ruil formulier.\r\n02-09-23 Terence Koerse, Aanvraag Ruil/Extra op huidige dag toegestaan.\r\n05-09-23 Houwelingen Marcel van ,Aantal mensen per werkplek als optie. ";
            
            AddText(tekst);

            // add HoofdstukText
            AddHoofdstuk("Hoofdstuk laast");

            AddLink("Dit is een Link", "C:\\Source\\C#");

        }

        private Panel MaakNewPanel()
        {
            // maak new panel
            Panel panel = new Panel();
            panel.Dock = DockStyle.Top;
            panel.BorderStyle = BorderStyle.None;
            panel.AutoSize = true;
            panelMain.Controls.Add(panel);
            panelMain.Controls.SetChildIndex(panel, 0);
            
            panel.Click += new System.Windows.Forms. LinkLabelLinkClickedEventHandler(label_LinkClicked);
            
            return panel;
        }

        private void AddHoofdstuk(string text)
        {
            Panel panel = MaakNewPanel();

            System.Windows.Forms.Label label = new System.Windows.Forms.Label();
            label.AutoSize = true;
            label.Font = new Font("Microsoft Sans Serif", 18, FontStyle.Bold);
            label.Text = "   " + text;
            panel.Controls.Add(label);
        }

        private void AddText(string tekst)
        {
            Panel panel = MaakNewPanel();

            System.Windows.Forms.Label label = new System.Windows.Forms.Label();
            label.AutoSize = true;
            label.Font = new Font("Microsoft Sans Serif", 11, FontStyle.Regular);
            label.Text = tekst;
            // tel aantal regels.
            int regels = 0;
            for (int i = 0; i < tekst.Length; i++)
                if (tekst[i] == '\r') regels++;
            panel.Controls.Add(label);
        }

        private void AddLink(string link, string locatie)
        {
            Panel panel = MaakNewPanel();

            System.Windows.Forms.LinkLabel label = new System.Windows.Forms.LinkLabel();
            label.AutoSize = true;
            label.Font = new Font("Microsoft Sans Serif", 11, FontStyle.Regular);
            label.Text = link;
            label.Tag = locatie;
            
            label.LinkClicked += new System.Windows.Forms.LinkLabelLinkClickedEventHandler(label_LinkClicked);

            panel.Controls.Add(label);
        }

        void label_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
        {
            System.Windows.Forms.LinkLabel label = (System.Windows.Forms.LinkLabel)sender;
            label.LinkVisited = true;
            Process process = new Process();
            process.StartInfo.FileName = (string)label.Tag;
            process.Start();
        }

        private void panel1_Click(object sender, EventArgs e)
        {

        }
    }
}
